<!DOCTYPE html>
<html lang="en" translate="no">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="不吃貓的魚">
    <meta name="description"
        content="財團法人台灣關愛基金會（關愛之家）於2011年成立。創辦人楊婕妤女士從1986年開始投入愛滋感染者社區臨床照顧工作，提供愛滋感染者安心養病的環境，亦提供愛滋寶寶的照顧服務。隨著醫學技術的發展，目前台灣已沒有愛滋寶寶的降生，而因緣際會展開了弱勢移工婦女及其子女的照顧服務，也接受社會局轉介本國籍孩童，將服務擴大成不分國籍的兒童">


    <title>給「移」樣的孩子，一樣的愛</title>
    <!-- <link href="https://cdn.jsdelivr.net/npm/reset-css@5.0.2/reset.min.css" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+Mono+TC&display=swap" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=LXGW+WenKai+Mono+TC&family=Noto+Serif+TC:wght@200..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="./stylesheet/all.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
</head>

<body>
    <audio id="music" preload="auto" src="./audio/それから５ヶ月.mp3"></audio>
    <audio id="cardflip" preload="auto" src="./audio/Twinkle Bright Up.wav"></audio>
    <audio id="flipme" preload="auto" src="./audio/Page Flip.mp3" loop="0"></audio>
    <!-- intro animation -->
    <!-- <div id="introbg">
        <div class="outframe">
            <main class="loadframe">
                <div class="loading"></div>
                <div class="loading second"></div>
                <h2 class="num">0%</h2>
            </main>
        </div>
        <img id="intrologo" src="./img/關愛LOGO.png" alt="" style="opacity: 0;max-width: 375px;">
    </div> -->

    <!-- PC navbar -->
    <nav class="navbar navbar-expand-md navbar-light bg-light fs-4 z-1 d-none d-md-block">
        <div class="container-fluid ">
            <a class="navbar-brand" href="#">
                <img class="tp-0" src="./img/logo.png" alt="" width="120">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false"
                aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="#">認識關愛</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">服務內容</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">愛心捐款</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">聯絡我們</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- container -->
    <div class="container align-content-center">
        <!-- mobile navbar -->
        <nav class="navbar navbar-expand-md navbar-light bg-light fs-4 z-1 d-md-none position-absolute p-0 rounded rounded-1 m-1"
            style="width: 80px;">
            <div class="container-fluid p-0 rounded rounded-1 p-1 justify-content-center"
                style="background-color: rgba(192, 192, 192, 0.705);">
                <a class="navbar-brand d-none d-md-block" href="#">
                    <img class="tp-0" src="./img/logo.png" alt="" width="120">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto ps-1 pt-2 fs-6">
                        <li class="nav-item">
                            <a class="nav-link" aria-current="page" href="#">認識關愛</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">服務內容</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">愛心捐款</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#">聯絡我們</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>

        <!-- float sign -->
        <!-- <i class="bi bi-caret-down-fill bottom-0 start-50 translate-middle position-absolute"></i> -->

        <!-- main frame -->
        <div class="main">
            <!-- background -->
            <div class="bg"></div>
            <!-- music -->
            <a class="text-light border-light rounded-1 m-1" href="#" id="on-off">
                <i class="bi bi-volume-mute-fill"></i>
            </a>
            <!-- window -->
            <div id="window">
                <!-- start -->
                <div id="stframe" class="rounded-1 border bg-body text-center animate__animated animate__slow"
                    style="height: 100%;">
                    <h2>關愛童LOVE園</h2>
                    <p>
                        歡迎您來到給「移」樣的孩子一樣的愛，在這個遊戲中您將扮演一位將要出生的寶寶，依照您的每一個選擇，將會迎來不同的未來。
                        <br>
                        <br>
                        點選「開始遊戲」後，將會依照隨機決定您出生時的身分，請依照您所取得的身分體驗接下來您的人生。
                        <br>
                        <br>
                        備註：依照個案數據統計，合法與非法移工之子的比例約為1：9。
                    </p>
                    <button id="start" type="button" class="border-1 rounded-3">開始遊戲</button>
                </div>

                <!-- lotto -->
                <div class="lotto animate__animated animate__slow animate__fadeIn d-none">
                    <!-- <div class="w-100 lotto animate__animated animate__slow bg-transparent animate__fadeIn" style="aspect-ratio: 3/5;"> -->
                    <div class="idcard front animate__delay-2s">
                        <img src="https://i.pinimg.com/736x/7f/0f/bf/7f0fbf4ace73b111283f9c0a937c8d45.jpg">
                    </div>
                    <div class="idcard back animate__delay-2s">
                        <img src="https://i.pinimg.com/736x/7b/bd/32/7bbd32bb2cdfd281bc0b47a45f94779a.jpg">
                    </div>
                    <div class="dialog border-1 rounded-1 animate__animated animate__fadeIn d-none">
                        <p class="m-0 pb-3 fs-5">
                            您的身分為「<span class="identity"></span>」
                            <br>
                            若想更改身分可以再次點擊畫面
                            <button id="checkid">確定身分並開始人生</button>
                        </p>
                        <i class="bi bi-caret-down-fill"></i>
                    </div>
                </div>

                <div id="game"
                    class="question d-none animate__animated animate__slow animate__fadeIn border-1 rounded-2"
                    style="background-color: rgba(255,255,255,0.5);">
                    <!-- <h3 class="p-3" style="text-align: justify;">剛出生的你感受到了環境中各種聲音，你所聽到的是？</h3>
                    <a class="option2">蟲鳴與蛙鳴</a>
                    <a class="option2">各國語言的對話<br>聲音中充滿著激勵的能量</a>
                    <a class="option2">有著穩定且規律的儀器聲響</a> -->
                </div>

                <!-- <div class="question stage1 d-none h-100 w-100 animate__animated animate__slow animate__fadeIn border-1 rounded-2"
                    style="background-color: rgba(255,255,255,0.5);">
                    <h3 class="p-3" style="text-align: justify;">剛出生的你感受到了環境中各種聲音，你所聽到的是？</h3>
                    <ol class="optionlist">
                        <li class="option1">蟲鳴與蛙鳴</li>
                        <li class="option1">各國語言的對話<br>聲音中充滿著激勵的能量</li>
                        <li class="option1">有著穩定且規律的儀器聲響</li>
                    </ol>
                    <div class="option border-1 bg-warning">
                    </div>
                </div> -->




            </div>
        </div>
    </div>
    </div>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ"
        crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

    <script>
        let bgmstatus = false;
        let audio = $('#music')[0];
        let flipme = $('#flipme')[0];
        let cardflip = $('#cardflip')[0];
        let sw = $('#on-off i')[0];
        audio.volume = 0.8
        flipme.volume = 0.6
        flipme.loop = false
        cardflip.volume = 0.6
        cardflip.loop = false


        let identity = 'legal'
        let flip = false

        $('#on-off').on('click', function (e) {
            e.preventDefault();
            $(sw).toggleClass('bi-volume-mute-fill')
            $(sw).toggleClass('bi-volume-up-fill')
            if (bgmstatus == false) {
                audio.play();
                bgmstatus = true;
                return;
            } else {
                audio.pause();
                bgmstatus = false;
                return;
            }
        })

        $('#start').on('click', function (e) {
            e.preventDefault();
            $('#on-off').click()
            flipme.play()
            setTimeout(() => {
                $('#stframe').addClass('animate__fadeOutTopRight')
            }, 200);
            setTimeout(function () {
                $('#stframe').remove()
                $('.lotto').removeClass('d-none')
                $('.lotto').addClass('animate__fadeIn')
            }, 2500)
        })

        $('.idcard').on('click', function (e) {
            if (!flip) {
                e.preventDefault();
                flip = true
                $('.dialog').addClass('d-none')
                $('.lotto .front').removeClass('ryp')
                $('.lotto .back').removeClass('ryn')
                cardflip.play()
                setTimeout(function () {
                    let random = Math.floor(Math.random() * 10)
                    $('.lotto .front').addClass('ryp')
                    $('.lotto .back').addClass('ryn')
                    $('.identity').text(`${random < 1 ? '合法移工之子' : '非法移工之子'}`)
                    $('.identity').attr('data-id', `${random < 1 ? 'legal' : 'illegal'}`)
                    $('.identity').attr('data-id', `${random < 1 ? identity = 'legal' : identity = 'illegal'}`)
                }, 1)
                setTimeout(() => {
                    $('.dialog').removeClass('d-none')
                }, 3500);
                setTimeout(() => {
                    flip = false
                }, 4000);
            }
        })

        $('.option2').on('click', function (e) {
            e.preventDefault();
            $(this).addClass('option2a');
            setTimeout(() => {
                $(this).removeClass('option2a');
            }, 500);
        })

        $('#checkid').on('click', function (e) {
            flip = true
            $('.lotto').removeClass('animate__fadeIn')
            $('.lotto').addClass('animate__fadeOut')
            setTimeout(() => {
                $('.lotto').remove()
                $("#game").removeClass("d-none");  // 顯示遊戲對話區
                renderNode(currentNode);           // 執行顯示第一節點
            }, 2000);
        })


    </script>

    <script>
        let rad;
        for (var i = 0; i < 2001; i++) {
            (function (x) {
                window.setTimeout(function () {
                    $('.second').attr('style', `bottom:${300 * x / 2000}px`)
                    if (x % 20 == 0) {
                        $('.num').text(`${100 * x / 2000}%`)
                    }
                    if (x >= '2000') {
                        $('#intrologo').addClass('animate__animated animate__fadeIn ')
                        setTimeout(() => {
                            $('.loadframe').addClass('loadover')
                            $('#intrologo').removeClass('animate__fadeIn')
                            $('#intrologo').addClass('animate__fadeOut')
                            $('#introbg').addClass('bgfadeout')
                            setTimeout(() => {
                                $('#introbg').remove()
                            }, 1500);
                        }, 1000);
                    }
                }, 1000 + 2 * (x + Math.random() * 10));
            })(i);
        }
    </script>

    <script>
        function safariHacks() {
            let windowsVH = window.innerHeight / 100;
            document.querySelector('.container').style.setProperty('--vh', windowsVH + 'px');
            document.querySelector('.main').style.setProperty('--vh', windowsVH + 'px');
            window.addEventListener('resize', function () {
                document.querySelector('.container').style.setProperty('--vh', windowsVH + 'px');
                document.querySelector('.main').style.setProperty('--vh', windowsVH + 'px');
            });
        }
        safariHacks();
    </script>

    <script>
        let currentNode = "";
        let story = "";
        $.ajax({
            url: './text/story.json',
            method: 'GET',
            dataType: 'json',
            data: '',
            async: true,

            success: res => {
                story = res;
                currentNode = "where";
            },
            error: err => {
                console.log(err)
            },
        });

        function renderNode(nodeKey) {
            const node = story[nodeKey];
            if (!node) return;

            const container = $("#game");
            container.empty();  // 清空舊內容

            const dialog = node.dialog;

            // 顯示標題
            if (dialog.head) {
                container.append(`<h3 class="mb-3">${dialog.head}</h3>`);
            }

            // 顯示內容
            if (dialog.description) {
                container.append(`<p class="mb-4">${dialog.description.replace(/\n/g, "<br>")}</p>`);
            }

            // 顯示按鈕或選項
            if (node.type === "question") {
                const options = dialog.options;
                for (const key in options) {
                    const opt = options[key];
                    if (opt.condition === "none" || opt.condition === identity) {
                        container.append(`
                    <a class="option2" data-goto="${opt.goto}">
                        ${opt.description.replace(/\n/g, "<br>")}
                    </a>
                `);
                    }
                }
            } else {
                const btnText = dialog.btn || "繼續";
                container.append(`
            <a class="option2" data-goto="${node.goto}" ">${btnText}</a>
            `);
            }
        }

        $(document).on('click', function (e) {
            // console.log($(e.target)[0].nodeName == "A")
            // console.log($(e.target).hasClass('option2'))
            if ($(e.target)[0].nodeName == "A" && $(e.target).hasClass('option2')) {
                $(e.target).addClass('option2a');
                setTimeout(() => {
                    $(e.target).removeClass('option2a');
                    console.log($(e.target).data('goto'))
                    let currentNode = $(e.target).data('goto')
                    renderNode(currentNode)
                }, 500);
            }
        })


    </script>
</body>

</html>